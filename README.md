
# Templater defaults Plugin for CakePHP

[![PHPStan Level 8](https://img.shields.io/badge/PHPStan-level%208-brightgreen)](https://github.com/josbeir/cakephp-templater-defaults)
[![Build Status](https://github.com/josbeir/cakephp-templater-defaults/actions/workflows/ci.yml/badge.svg)](https://github.com/josbeir/cakephp-latte-view/actions)
[![codecov](https://codecov.io/gh/josbeir/cakephp-templater-defaults/graph/badge.svg?token=EYUO9IRM9F)](https://codecov.io/gh/josbeir/cakephp-templater-defaults)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PHP Version](https://img.shields.io/badge/php-8.2%2B-blue.svg)](https://www.php.net/releases/8.2/en.php)
[![Packagist Downloads](https://img.shields.io/packagist/dt/josbeir/cakephp-templater-defaults)](https://packagist.org/packages/josbeir/cakephp-templater-defaults)


A custom templater for CakePHP that enables you to define default HTML attributes within CakePHP's string template system, making it easier to integrate with your preferred CSS setups and streamline HTML markup generated by helpers.

CakePHP's StringTemplates system does not allow merging attributes set at runtime with attributes defined in the template. This little plugin fixes this problem.

---

## Table of Contents

1. [Features](#features)
2. [Installation](#installation)
3. [Usage](#usage)
4. [Examples](#examples)
5. [Limitations](#limitations)
6. [Contributing](#contributing)
7. [License](#license)

## Features

- **Attribute Merging**: Runtime attributes are merged with template defaults, allowing easy extension or override.
- **Attribute Swapping**: Use the `:swap` suffix (e.g. `class:swap`) to completely replace a default attribute value.
- **Works with CakePHP Helpers**: Seamlessly integrates with helpers like `FormHelper` via the `templateClass` option.

## Installation

Install via Composer:

```bash
composer require josbeir/cakephp-templater-defaults
```

## Why

Imagine this template defintion for your FormHelper
```php
'templates' => [
    'input' => '<input class="border border-slate-500 rounded-sm max-w-md min-w-4" type="{{type}}" name="{{name}}"{{attrs}}>',
];
```

In many cases you will want to add classes to control the size, width, etc. of those elements. This is not possible in core's `StringTemplate` unless you override the entire template at runtime on a per-element basis.

```php
$this->Form->control('field', ['class' => 'extra-class']);
// Renders to
<div class="input text">
  <label>...</label>
  <input class="border border-slate-500 rounded-sm max-w-md min-w-4" type="text" name="field" class="extra-class">
</div>
```

**This is not expected behavior.**

Rather than doing that, this plugin uses a different approach: it merges the existing (default) attributes with ones defined at runtime:

```php
$this->Form->control('field', ['class' => 'extra-class']);
// Renders to
<div class="input text">
  <label>...</label>
  <input class="border border-slate-500 rounded-sm max-w-md min-w-4 extra-class" type="text" name="field">
</div>
```

## Usage

You can use the custom `StringTemplate` class directly or configure CakePHP helpers (like `FormHelper`) to use it:

In your `AppView.php`, set the `templateClass` option on any helper where you want to use this plugin.

```php
use \TemplaterDefaults\View\StringTemplate;

$this->loadHelper('Form', [
    'templateClass' => StringTemplate::class,
]);
```

## Examples

### Attribute Merging

Default and runtime classes are merged:

```php
// In your template file (e.g. src/Template/Example/index.php)
echo $this->Form->control('field', [
	'type' => 'text',
	'class' => 'runtime',
]);
// <input class="default runtime" ... >
```

### Attribute Swapping

Use `class:swap` to replace the default:

```php
echo $this->Form->control('field', [
	'type' => 'text',
	'class:swap' => 'swapped',
]);
// <input class="swapped" ... >
```

Or removing the default attribute.
```php
echo $this->Form->control('field', [
	'type' => 'text',
	'class:swap' => '',
]);

// <input ... >
```

## Limitations

* Default attributes obviously only work on html/xml style templates
* Only the top level element will be populated. Nested elements are ignored.

## Contributing

Contributions, issues, and feature requests are welcome! Feel free to open a pull request or issue on GitHub. Please follow CakePHP coding standards and ensure all code is properly tested before submitting.

## License

[MIT](LICENSE.md)
