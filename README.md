
# Templater defaults Plugin for CakePHP

[![PHPStan Level 8](https://img.shields.io/badge/PHPStan-level%208-brightgreen)](https://github.com/josbeir/cakephp-templater-defaults)
[![Build Status](https://github.com/josbeir/cakephp-templater-defaults/actions/workflows/ci.yml/badge.svg)](https://github.com/josbeir/cakephp-latte-view/actions)
[![codecov](https://codecov.io/gh/josbeir/cakephp-templater-defaults/graph/badge.svg?token=EYUO9IRM9F)](https://codecov.io/gh/josbeir/cakephp-templater-defaults)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PHP Version](https://img.shields.io/badge/php-8.2%2B-blue.svg)](https://www.php.net/releases/8.2/en.php)
[![Packagist Downloads](https://img.shields.io/packagist/dt/josbeir/cakephp-templater-defaults)](https://packagist.org/packages/josbeir/cakephp-templater-defaults)


A custom templater for CakePHP that enables you to define default HTML attributes within CakePHP's string template system, making it easier to integrate with your preferred CSS setups and streamline html markup generated by helpers.

## Features

- Easy setup
- Define default attributes and values for CakePHP string templates
- Merge default attributes and runtime attributes seamlessly (e.g., for classes)
- Simplifies integration with CSS frameworks (I'm looking at you `tailwind`)

## Requirements

- CakePHP 5.0 or higher
- PHP 8.2 or higher

## Installation

Install this plugin into your CakePHP application using [Composer](https://getcomposer.org):

```bash
composer require josbeir/cakephp-templater-defaults
```

## Motivation

CakePHP's default string template system does not provide a straightforward way to define a default set of classes or attributes that align with your CSS framework. Instead of extending helpers or manually adding attributes throughout your application, this plugin offers a clean and maintainable alternative: set default attribute values directly in your template definitions. This approach works with any CakePHP helper that utilizes string templates.

The current way would be defining attributes on your template but when you want to add extra classes to them, things stop working as those attributes are then mostly added to the {{attr}} token.

```php
// Imagine this template
['input' => '<input type="{{type}}" name="{{name}}" class="defaultClass" {{attrs}}>']

// Render with FormHelper
$this->Form->input('field', ['class' => 'customClass']);
```

Renders to

```html
<input type="text" name="field" class="defaultClass" class="customClass" />
```

As you can see in the example above, the `class` is added twice. This is of course **not the inteded result**.

## Usage

### 1. Configure the Helper

In your `AppView.php`, specify the custom template class for any helper you want to use with default attributes:

```php
// In src/View/AppView.php
use TemplaterDefaults\View\StringTemplate;

$this->loadHelper('Form', [
    'templateClass' => StringTemplate::class,
    'templates' => 'my_app_templates', // Your template defintion
]);
```

### 2. Define Templates with defaults

Add default attributes to your templates. For example, to set a default class and a custom data attribute for all input fields:

```php
'templates' => [
    // Default behavior.
    'inputContainer' => '<div class="{{containerClass}} {{type}}{{required}}">{{content}}</div>',
    // With default attributes.
    'input' => [
        'template' => '<input type="{{type}}" name="{{name}}"{{attrs}}>',
        'defaults' => [
            'class' => 'defaultClass',
            'data-star' => 'wars',
        ],
    ],
],
```

Now, every input field will automatically include the default class and data attribute:

```php
<?= $this->Form->control('field'); ?>
```

Renders to

```html
<input type="text" name="field" class="defaultClass" data-star="wars" />
```

### 3. Merging default and runtime values

If you want to merge default values with those provided at runtime (e.g., for classes), use an array for the default value:

```php
'templates' => [
    'input' => [
        'template' => '<input type="{{type}}" name="{{name}}"{{attrs}}>',
        'defaults' => [
            'class' => ['firstClass', 'secondClass'],
        ],
    ],
],
```

When you specify a class at runtime, it will be merged:

```php
<?= $this->Form->control('field', ['class' => 'thirdClass']); ?>
```

Renders to

```html
<input type="text" name="field" class="firstClass secondClass thirdClass" />
```

### 4. Advanced Example: Multiple Attributes

You can set defaults for any attribute, including data attributes and ARIA properties:

```php
'templates' => [
    'input' => [
        'template' => '<input type="{{type}}" name="{{name}}"{{attrs}}>',
        'defaults' => [
            'class' => ['form-control', 'mb-2'],
            'data-toggle' => 'custom',
            'aria-label' => 'Custom input',
        ],
    ],
],
```

```php
echo $this->Form->control('username', [
    'class' => 'is-invalid',
    'data-toggle' => 'override',
]); ?>
```

Renders to

```html
<input type="text" name="username" class="form-control mb-2 is-invalid" data-toggle="override" aria-label="Custom input" />
```

## Contributing

Contributions, issues, and feature requests are welcome! Feel free to open a pull request or issue on GitHub. Please follow CakePHP coding standards and ensure all code is properly tested before submitting.

## License

[MIT](LICENSE.md)
